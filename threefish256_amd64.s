// func fourRoundsA(state *[4]uint64) {
TEXT	路fourRoundsA(SB), $0-8
	MOVQ	state+0(FP), AX
	MOVQ	(AX), R10
	MOVQ	8(AX), R11
	MOVQ	16(AX), R12
	MOVQ	24(AX), R13

	ADDQ	R11, R10	// y0 = x0 + x1
	ROLQ	$14, R11	// y1 = x0 <<< 14
	XORQ	R10, R11	// y1 ^= y0
	ADDQ	R13, R12
	ROLQ	$16, R13
	XORQ	R12, R13

	ADDQ	R13, R10
	ROLQ	$52, R13
	XORQ	R10, R13
	ADDQ	R11, R12
	ROLQ	$57, R11
	XORQ	R12, R11

	ADDQ	R11, R10
	ROLQ	$23, R11
	XORQ	R10, R11
	ADDQ	R13, R12
	ROLQ	$40, R13
	XORQ	R12, R13
	
	ADDQ	R13, R10
	ROLQ	$5, R13
	XORQ	R10, R13
	ADDQ	R11, R12
	ROLQ	$37, R11
	XORQ	R12, R11

	MOVQ	R10, (AX)
	MOVQ	R11, 8(AX)
	MOVQ	R12, 16(AX)
	MOVQ	R13, 24(AX)

	RET

// func fourRoundsB(state *[4]uint64) {
TEXT	路fourRoundsB(SB), $0-8
	MOVQ	state+0(FP), AX
	MOVQ	(AX), R10
	MOVQ	8(AX), R11
	MOVQ	16(AX), R12
	MOVQ	24(AX), R13

	ADDQ	R11, R10	// y0 = x0 + x1
	ROLQ	$25, R11	// y1 = x0 <<< 25
	XORQ	R10, R11	// y1 ^= y0
	ADDQ	R13, R12
	ROLQ	$33, R13
	XORQ	R12, R13

	ADDQ	R13, R10
	ROLQ	$46, R13
	XORQ	R10, R13
	ADDQ	R11, R12
	ROLQ	$12, R11
	XORQ	R12, R11

	ADDQ	R11, R10
	ROLQ	$58, R11
	XORQ	R10, R11
	ADDQ	R13, R12
	ROLQ	$22, R13
	XORQ	R12, R13
	
	ADDQ	R13, R10
	ROLQ	$32, R13
	XORQ	R10, R13
	ADDQ	R11, R12
	ROLQ	$32, R11
	XORQ	R12, R11

	MOVQ	R10, (AX)
	MOVQ	R11, 8(AX)
	MOVQ	R12, 16(AX)
	MOVQ	R13, 24(AX)

	RET

// func reverseFourRoundsA(state *[4]uint64) {
TEXT	路reverseFourRoundsA(SB), $0-8
	MOVQ	state+0(FP), AX
	MOVQ	(AX), R10
	MOVQ	8(AX), R11
	MOVQ	16(AX), R12
	MOVQ	24(AX), R13

	XORQ	R12, R11
	RORQ	$37, R11
	SUBQ	R11, R12
	XORQ	R10, R13
	RORQ	$5, R13
	SUBQ	R13, R10

	XORQ	R12, R13
	RORQ	$40, R13
	SUBQ	R13, R12
	XORQ	R10, R11
	RORQ	$23, R11
	SUBQ	R11, R10

	XORQ	R12, R11
	RORQ	$57, R11
	SUBQ	R11, R12
	XORQ	R10, R13
	RORQ	$52, R13
	SUBQ	R13, R10

	XORQ	R12, R13
	RORQ	$16, R13
	SUBQ	R13, R12
	XORQ	R10, R11
	RORQ	$14, R11
	SUBQ	R11, R10

	MOVQ	R10, (AX)
	MOVQ	R11, 8(AX)
	MOVQ	R12, 16(AX)
	MOVQ	R13, 24(AX)

	RET

// func reverseFourRoundsB(state *[4]uint64) {
TEXT	路reverseFourRoundsB(SB), $0-8
	MOVQ	state+0(FP), AX
	MOVQ	(AX), R10
	MOVQ	8(AX), R11
	MOVQ	16(AX), R12
	MOVQ	24(AX), R13

	XORQ	R12, R11
	RORQ	$32, R11
	SUBQ	R11, R12
	XORQ	R10, R13
	RORQ	$32, R13
	SUBQ	R13, R10

	XORQ	R12, R13
	RORQ	$22, R13
	SUBQ	R13, R12
	XORQ	R10, R11
	RORQ	$58, R11
	SUBQ	R11, R10

	XORQ	R12, R11
	RORQ	$12, R11
	SUBQ	R11, R12
	XORQ	R10, R13
	RORQ	$46, R13
	SUBQ	R13, R10

	XORQ	R12, R13
	RORQ	$33, R13
	SUBQ	R13, R12
	XORQ	R10, R11
	RORQ	$25, R11
	SUBQ	R11, R10

	MOVQ	R10, (AX)
	MOVQ	R11, 8(AX)
	MOVQ	R12, 16(AX)
	MOVQ	R13, 24(AX)

	RET
