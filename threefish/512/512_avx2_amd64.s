DATA c240<>+0x00(SB)/8, $0x1bd11bdaa9fc1a22
DATA c240<>+0x08(SB)/8, $0x1bd11bdaa9fc1a22
DATA c240<>+0x10(SB)/8, $0x1bd11bdaa9fc1a22
DATA c240<>+0x18(SB)/8, $0x1bd11bdaa9fc1a22
GLOBL c240<>(SB), (8+16), $32

DATA round0<>+0x0000(SB)/8, $0x0000000000000000
DATA round0<>+0x0008(SB)/8, $0x0000000000000000
DATA round0<>+0x0010(SB)/8, $0x0000000000000000
DATA round0<>+0x0018(SB)/8, $0x0000000000000000
GLOBL round0<>(SB), (8+16), $32

DATA round1<>+0x0000(SB)/8, $0x0000000000000001
DATA round1<>+0x0008(SB)/8, $0x0000000000000001
DATA round1<>+0x0010(SB)/8, $0x0000000000000001
DATA round1<>+0x0018(SB)/8, $0x0000000000000001
GLOBL round1<>(SB), (8+16), $32

DATA round2<>+0x0000(SB)/8, $0x0000000000000002
DATA round2<>+0x0008(SB)/8, $0x0000000000000002
DATA round2<>+0x0010(SB)/8, $0x0000000000000002
DATA round2<>+0x0018(SB)/8, $0x0000000000000002
GLOBL round2<>(SB), (8+16), $32

DATA round3<>+0x0000(SB)/8, $0x0000000000000003
DATA round3<>+0x0008(SB)/8, $0x0000000000000003
DATA round3<>+0x0010(SB)/8, $0x0000000000000003
DATA round3<>+0x0018(SB)/8, $0x0000000000000003
GLOBL round3<>(SB), (8+16), $32

DATA round4<>+0x0000(SB)/8, $0x0000000000000004
DATA round4<>+0x0008(SB)/8, $0x0000000000000004
DATA round4<>+0x0010(SB)/8, $0x0000000000000004
DATA round4<>+0x0018(SB)/8, $0x0000000000000004
GLOBL round4<>(SB), (8+16), $32

DATA round5<>+0x0000(SB)/8, $0x0000000000000005
DATA round5<>+0x0008(SB)/8, $0x0000000000000005
DATA round5<>+0x0010(SB)/8, $0x0000000000000005
DATA round5<>+0x0018(SB)/8, $0x0000000000000005
GLOBL round5<>(SB), (8+16), $32

DATA round6<>+0x0000(SB)/8, $0x0000000000000006
DATA round6<>+0x0008(SB)/8, $0x0000000000000006
DATA round6<>+0x0010(SB)/8, $0x0000000000000006
DATA round6<>+0x0018(SB)/8, $0x0000000000000006
GLOBL round6<>(SB), (8+16), $32

DATA round7<>+0x0000(SB)/8, $0x0000000000000007
DATA round7<>+0x0008(SB)/8, $0x0000000000000007
DATA round7<>+0x0010(SB)/8, $0x0000000000000007
DATA round7<>+0x0018(SB)/8, $0x0000000000000007
GLOBL round7<>(SB), (8+16), $32

DATA round8<>+0x0000(SB)/8, $0x0000000000000008
DATA round8<>+0x0008(SB)/8, $0x0000000000000008
DATA round8<>+0x0010(SB)/8, $0x0000000000000008
DATA round8<>+0x0018(SB)/8, $0x0000000000000008
GLOBL round8<>(SB), (8+16), $32

DATA round9<>+0x0000(SB)/8, $0x0000000000000009
DATA round9<>+0x0008(SB)/8, $0x0000000000000009
DATA round9<>+0x0010(SB)/8, $0x0000000000000009
DATA round9<>+0x0018(SB)/8, $0x0000000000000009
GLOBL round9<>(SB), (8+16), $32

DATA round10<>+0x0000(SB)/8, $0x000000000000000a
DATA round10<>+0x0008(SB)/8, $0x000000000000000a
DATA round10<>+0x0010(SB)/8, $0x000000000000000a
DATA round10<>+0x0018(SB)/8, $0x000000000000000a
GLOBL round10<>(SB), (8+16), $32

DATA round11<>+0x0000(SB)/8, $0x000000000000000b
DATA round11<>+0x0008(SB)/8, $0x000000000000000b
DATA round11<>+0x0010(SB)/8, $0x000000000000000b
DATA round11<>+0x0018(SB)/8, $0x000000000000000b
GLOBL round11<>(SB), (8+16), $32

DATA round12<>+0x0000(SB)/8, $0x000000000000000c
DATA round12<>+0x0008(SB)/8, $0x000000000000000c
DATA round12<>+0x0010(SB)/8, $0x000000000000000c
DATA round12<>+0x0018(SB)/8, $0x000000000000000c
GLOBL round12<>(SB), (8+16), $32

DATA round13<>+0x0000(SB)/8, $0x000000000000000d
DATA round13<>+0x0008(SB)/8, $0x000000000000000d
DATA round13<>+0x0010(SB)/8, $0x000000000000000d
DATA round13<>+0x0018(SB)/8, $0x000000000000000d
GLOBL round13<>(SB), (8+16), $32

DATA round14<>+0x0000(SB)/8, $0x000000000000000e
DATA round14<>+0x0008(SB)/8, $0x000000000000000e
DATA round14<>+0x0010(SB)/8, $0x000000000000000e
DATA round14<>+0x0018(SB)/8, $0x000000000000000e
GLOBL round14<>(SB), (8+16), $32

DATA round15<>+0x0000(SB)/8, $0x000000000000000f
DATA round15<>+0x0008(SB)/8, $0x000000000000000f
DATA round15<>+0x0010(SB)/8, $0x000000000000000f
DATA round15<>+0x0018(SB)/8, $0x000000000000000f
GLOBL round15<>(SB), (8+16), $32

DATA round16<>+0x0000(SB)/8, $0x0000000000000010
DATA round16<>+0x0008(SB)/8, $0x0000000000000010
DATA round16<>+0x0010(SB)/8, $0x0000000000000010
DATA round16<>+0x0018(SB)/8, $0x0000000000000010
GLOBL round16<>(SB), (8+16), $32

DATA round17<>+0x0000(SB)/8, $0x0000000000000011
DATA round17<>+0x0008(SB)/8, $0x0000000000000011
DATA round17<>+0x0010(SB)/8, $0x0000000000000011
DATA round17<>+0x0018(SB)/8, $0x0000000000000011
GLOBL round17<>(SB), (8+16), $32

DATA round18<>+0x0000(SB)/8, $0x0000000000000012
DATA round18<>+0x0008(SB)/8, $0x0000000000000012
DATA round18<>+0x0010(SB)/8, $0x0000000000000012
DATA round18<>+0x0018(SB)/8, $0x0000000000000012
GLOBL round18<>(SB), (8+16), $32


DATA gatherMask<>+0x0000(SB)/8, $0xffffffffffffffff
DATA gatherMask<>+0x0008(SB)/8, $0xffffffffffffffff
DATA gatherMask<>+0x0010(SB)/8, $0xffffffffffffffff
DATA gatherMask<>+0x0018(SB)/8, $0xffffffffffffffff
GLOBL gatherMask<>(SB), (8+16), $32

DATA stateStride<>+0x0000(SB)/8, $0x0000000000000000
DATA stateStride<>+0x0008(SB)/8, $0x0000000000000020
DATA stateStride<>+0x0010(SB)/8, $0x0000000000000040
DATA stateStride<>+0x0018(SB)/8, $0x0000000000000080
GLOBL stateStride<>(SB), (8+16), $32

DATA tweakStride<>+0x0000(SB)/8, $0x0000000000000000
DATA tweakStride<>+0x0008(SB)/8, $0x0000000000000002
DATA tweakStride<>+0x0010(SB)/8, $0x0000000000000004
DATA tweakStride<>+0x0018(SB)/8, $0x0000000000000006
GLOBL tweakStride<>(SB), (8+16), $32

DATA writeOneMask<>+0x0000(SB)/8, $0xffffffffffffffff
DATA writeOneMask<>+0x0008(SB)/8, $0x0000000000000000
DATA writeOneMask<>+0x0010(SB)/8, $0x0000000000000000
DATA writeOneMask<>+0x0018(SB)/8, $0x0000000000000000
GLOBL writeOneMask<>(SB), (8+16), $32


// state, key, and tweak must all be 32-byte aligned.
// func threefish512_avx2(state *uint64, key *uint64, tweak *uint64)
TEXT   Â·threefish512_avx2(SB), $-4-24
	// Transpose state data in place
	MOVQ	state+0(FP), R10
	MOVQ 8(R10), R8
	MOVQ 64(R10), R9
	MOVQ R9, 8(R10)
	MOVQ R8, 64(R10)

	MOVQ 16(R10), R8
	MOVQ 128(R10), R9
	MOVQ R9, 16(R10)
	MOVQ R8, 128(R10)

	MOVQ 24(R10), R8
	MOVQ 192(R10), R9
	MOVQ R9, 24(R10)
	MOVQ R8, 192(R10)

	MOVQ 40(R10), R8
	MOVQ 96(R10), R9
	MOVQ R9, 40(R10)
	MOVQ R8, 96(R10)

	MOVQ 48(R10), R8
	MOVQ 160(R10), R9
	MOVQ R9, 48(R10)
	MOVQ R8, 160(R10)

	MOVQ 56(R10), R8
	MOVQ 224(R10), R9
	MOVQ R9, 56(R10)
	MOVQ R8, 224(R10)

	MOVQ 80(R10), R8
	MOVQ 136(R10), R9
	MOVQ R9, 80(R10)
	MOVQ R8, 136(R10)

	MOVQ 88(R10), R8
	MOVQ 200(R10), R9
	MOVQ R9, 88(R10)
	MOVQ R8, 200(R10)

	MOVQ 112(R10), R8
	MOVQ 168(R10), R9
	MOVQ R9, 112(R10)
	MOVQ R8, 168(R10)

	MOVQ 120(R10), R8
	MOVQ 232(R10), R9
	MOVQ R9, 120(R10)
	MOVQ R8, 232(R10)

	MOVQ 152(R10), R8
	MOVQ 208(R10), R9
	MOVQ R9, 152(R10)
	MOVQ R8, 208(R10)

	MOVQ 184(R10), R8
	MOVQ 240(R10), R9
	MOVQ R9, 184(R10)
	MOVQ R8, 240(R10)

	// Load state data into Y0-Y7
	VMOVNTDQA	0(R10), Y0
	VMOVNTDQA	32(R10), Y4
	VMOVNTDQA	64(R10), Y1
	VMOVNTDQA	96(R10), Y5
	VMOVNTDQA	128(R10), Y2
	VMOVNTDQA	160(R10), Y6
	VMOVNTDQA	192(R10), Y3
	VMOVNTDQA	224(R10), Y7



	// Load the tweaks, then permute and blend as necessary to get them in the right order.
	MOVQ	tweak+16(FP), R8
	VMOVNTDQA	0(R8), Y14		// Tweaks for lanes 0 and 1
	VMOVNTDQA	32(R8), Y15		// Tweaks for lanes 2 and 3
	VPERMQ $-79, Y15, Y15
	VPBLENDD $0x33, Y14, Y15, Y10
	VPBLENDD $0xcc, Y14, Y15, Y11
	VPERMQ $-40, Y10, Y10  // 0xd8, waiting for bug to be fixed in go assembler
	VPERMQ $-115, Y11, Y11 // 0x73
	VPXOR		Y10, Y11, Y12


	// Load the key, then broadcast each value to create the extension.
	VMOVNTDQA	c240<>(SB), Y9
	MOVQ			key+8(FP), R8
	VMOVNTDQA		0(R8), Y13		// First half of the key, untransposed.
	VMOVNTDQA		32(R8), Y14		// Second half of the key, untransposed.

	// Rotate, broadcast, xor, until the extension has mixed with all of the first half of the key.
	VPBROADCASTQ	X13, Y15
	VPXOR			Y15, Y9, Y9
	VPERMQ			$0x17, Y13,	Y15
	VPBROADCASTQ	X15, Y15
	VPXOR			Y15, Y9, Y9
	VPERMQ			$0x17, Y13,	Y15
	VPBROADCASTQ	X15, Y15
	VPXOR			Y15, Y9, Y9
	VPERMQ			$0x17, Y13,	Y15
	VPBROADCASTQ	X15, Y15
	VPXOR			Y15, Y9, Y9

	// Rotate, broadcast, xor, until the extension has mixed with all of the second half of the key.
	VPBROADCASTQ	X14, Y15
	VPXOR			Y15, Y9, Y9
	VPERMQ			$0x17, Y14,	Y15
	VPBROADCASTQ	X15, Y15
	VPXOR			Y15, Y9, Y9
	VPERMQ			$0x17, Y14,	Y15
	VPBROADCASTQ	X15, Y15
	VPXOR			Y15, Y9, Y9
	VPERMQ			$0x17, Y14,	Y15
	VPBROADCASTQ	X15, Y15
	VPXOR			Y15, Y9, Y9



// Round 0
// Key Schedule
VPERMQ		$0x00, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y0, Y0
VPERMQ		$0x01, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y1, Y1
VPERMQ		$0x02, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y2, Y2
VPERMQ		$0x03, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y3, Y3
VPERMQ		$0x00, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y4, Y4
VPERMQ		$0x01, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y5, Y5
VPERMQ		$0x02, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y6, Y6
VPERMQ		$0x03, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y7, Y7
VPADDQ	Y10, Y5, Y5
VPADDQ	Y11, Y6, Y6

	VPADDQ	Y0, Y1, Y0
	VPSLLQ	$46, Y1, Y15
	VPSRLQ	$18, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y0, Y1, Y1


	VPADDQ	Y2, Y3, Y2
	VPSLLQ	$36, Y3, Y15
	VPSRLQ	$28, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y2, Y3, Y3


	VPADDQ	Y4, Y5, Y4
	VPSLLQ	$19, Y5, Y15
	VPSRLQ	$45, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y4, Y5, Y5


	VPADDQ	Y6, Y7, Y6
	VPSLLQ	$37, Y7, Y15
	VPSRLQ	$27, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y6, Y7, Y7

// Round 1

	VPADDQ	Y2, Y1, Y2
	VPSLLQ	$33, Y1, Y15
	VPSRLQ	$31, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y2, Y1, Y1


	VPADDQ	Y4, Y7, Y4
	VPSLLQ	$27, Y7, Y15
	VPSRLQ	$37, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y4, Y7, Y7


	VPADDQ	Y6, Y5, Y6
	VPSLLQ	$14, Y5, Y15
	VPSRLQ	$50, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y6, Y5, Y5


	VPADDQ	Y0, Y3, Y0
	VPSLLQ	$42, Y3, Y15
	VPSRLQ	$22, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y0, Y3, Y3

// Round 2

	VPADDQ	Y4, Y1, Y4
	VPSLLQ	$17, Y1, Y15
	VPSRLQ	$47, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y4, Y1, Y1


	VPADDQ	Y6, Y3, Y6
	VPSLLQ	$49, Y3, Y15
	VPSRLQ	$15, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y6, Y3, Y3


	VPADDQ	Y0, Y5, Y0
	VPSLLQ	$36, Y5, Y15
	VPSRLQ	$28, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y0, Y5, Y5


	VPADDQ	Y2, Y7, Y2
	VPSLLQ	$39, Y7, Y15
	VPSRLQ	$25, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y2, Y7, Y7

// Round 3

	VPADDQ	Y6, Y1, Y6
	VPSLLQ	$44, Y1, Y15
	VPSRLQ	$20, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y6, Y1, Y1


	VPADDQ	Y0, Y7, Y0
	VPSLLQ	$9, Y7, Y15
	VPSRLQ	$55, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y0, Y7, Y7


	VPADDQ	Y2, Y5, Y2
	VPSLLQ	$54, Y5, Y15
	VPSRLQ	$10, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y2, Y5, Y5


	VPADDQ	Y4, Y3, Y4
	VPSLLQ	$56, Y3, Y15
	VPSRLQ	$8, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y4, Y3, Y3

// Round 4
// Key Schedule
VPERMQ		$0x01, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y0, Y0
VPERMQ		$0x02, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y1, Y1
VPERMQ		$0x03, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y2, Y2
VPERMQ		$0x00, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y3, Y3
VPERMQ		$0x01, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y4, Y4
VPERMQ		$0x02, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y5, Y5
VPERMQ		$0x03, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y6, Y6
VPADDQ	Y9, Y7, Y7
VPADDQ	Y11, Y5, Y5
VPADDQ	Y12, Y6, Y6
VMOVNTDQA	round1<>(SB), Y15
VPADDQ Y15, Y7, Y7

	VPADDQ	Y0, Y1, Y0
	VPSLLQ	$39, Y1, Y15
	VPSRLQ	$25, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y0, Y1, Y1


	VPADDQ	Y2, Y3, Y2
	VPSLLQ	$30, Y3, Y15
	VPSRLQ	$34, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y2, Y3, Y3


	VPADDQ	Y4, Y5, Y4
	VPSLLQ	$34, Y5, Y15
	VPSRLQ	$30, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y4, Y5, Y5


	VPADDQ	Y6, Y7, Y6
	VPSLLQ	$24, Y7, Y15
	VPSRLQ	$40, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y6, Y7, Y7

// Round 5

	VPADDQ	Y2, Y1, Y2
	VPSLLQ	$13, Y1, Y15
	VPSRLQ	$51, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y2, Y1, Y1


	VPADDQ	Y4, Y7, Y4
	VPSLLQ	$50, Y7, Y15
	VPSRLQ	$14, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y4, Y7, Y7


	VPADDQ	Y6, Y5, Y6
	VPSLLQ	$10, Y5, Y15
	VPSRLQ	$54, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y6, Y5, Y5


	VPADDQ	Y0, Y3, Y0
	VPSLLQ	$17, Y3, Y15
	VPSRLQ	$47, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y0, Y3, Y3

// Round 6

	VPADDQ	Y4, Y1, Y4
	VPSLLQ	$25, Y1, Y15
	VPSRLQ	$39, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y4, Y1, Y1


	VPADDQ	Y6, Y3, Y6
	VPSLLQ	$29, Y3, Y15
	VPSRLQ	$35, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y6, Y3, Y3


	VPADDQ	Y0, Y5, Y0
	VPSLLQ	$39, Y5, Y15
	VPSRLQ	$25, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y0, Y5, Y5


	VPADDQ	Y2, Y7, Y2
	VPSLLQ	$43, Y7, Y15
	VPSRLQ	$21, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y2, Y7, Y7

// Round 7

	VPADDQ	Y6, Y1, Y6
	VPSLLQ	$8, Y1, Y15
	VPSRLQ	$56, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y6, Y1, Y1


	VPADDQ	Y0, Y7, Y0
	VPSLLQ	$35, Y7, Y15
	VPSRLQ	$29, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y0, Y7, Y7


	VPADDQ	Y2, Y5, Y2
	VPSLLQ	$56, Y5, Y15
	VPSRLQ	$8, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y2, Y5, Y5


	VPADDQ	Y4, Y3, Y4
	VPSLLQ	$22, Y3, Y15
	VPSRLQ	$42, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y4, Y3, Y3

// Round 8
// Key Schedule
VPERMQ		$0x02, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y0, Y0
VPERMQ		$0x03, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y1, Y1
VPERMQ		$0x00, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y2, Y2
VPERMQ		$0x01, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y3, Y3
VPERMQ		$0x02, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y4, Y4
VPERMQ		$0x03, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y5, Y5
VPADDQ	Y9, Y6, Y6
VPERMQ		$0x00, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y7, Y7
VPADDQ	Y12, Y5, Y5
VPADDQ	Y10, Y6, Y6
VMOVNTDQA	round2<>(SB), Y15
VPADDQ Y15, Y7, Y7

	VPADDQ	Y0, Y1, Y0
	VPSLLQ	$46, Y1, Y15
	VPSRLQ	$18, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y0, Y1, Y1


	VPADDQ	Y2, Y3, Y2
	VPSLLQ	$36, Y3, Y15
	VPSRLQ	$28, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y2, Y3, Y3


	VPADDQ	Y4, Y5, Y4
	VPSLLQ	$19, Y5, Y15
	VPSRLQ	$45, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y4, Y5, Y5


	VPADDQ	Y6, Y7, Y6
	VPSLLQ	$37, Y7, Y15
	VPSRLQ	$27, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y6, Y7, Y7

// Round 9

	VPADDQ	Y2, Y1, Y2
	VPSLLQ	$33, Y1, Y15
	VPSRLQ	$31, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y2, Y1, Y1


	VPADDQ	Y4, Y7, Y4
	VPSLLQ	$27, Y7, Y15
	VPSRLQ	$37, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y4, Y7, Y7


	VPADDQ	Y6, Y5, Y6
	VPSLLQ	$14, Y5, Y15
	VPSRLQ	$50, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y6, Y5, Y5


	VPADDQ	Y0, Y3, Y0
	VPSLLQ	$42, Y3, Y15
	VPSRLQ	$22, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y0, Y3, Y3

// Round 10

	VPADDQ	Y4, Y1, Y4
	VPSLLQ	$17, Y1, Y15
	VPSRLQ	$47, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y4, Y1, Y1


	VPADDQ	Y6, Y3, Y6
	VPSLLQ	$49, Y3, Y15
	VPSRLQ	$15, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y6, Y3, Y3


	VPADDQ	Y0, Y5, Y0
	VPSLLQ	$36, Y5, Y15
	VPSRLQ	$28, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y0, Y5, Y5


	VPADDQ	Y2, Y7, Y2
	VPSLLQ	$39, Y7, Y15
	VPSRLQ	$25, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y2, Y7, Y7

// Round 11

	VPADDQ	Y6, Y1, Y6
	VPSLLQ	$44, Y1, Y15
	VPSRLQ	$20, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y6, Y1, Y1


	VPADDQ	Y0, Y7, Y0
	VPSLLQ	$9, Y7, Y15
	VPSRLQ	$55, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y0, Y7, Y7


	VPADDQ	Y2, Y5, Y2
	VPSLLQ	$54, Y5, Y15
	VPSRLQ	$10, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y2, Y5, Y5


	VPADDQ	Y4, Y3, Y4
	VPSLLQ	$56, Y3, Y15
	VPSRLQ	$8, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y4, Y3, Y3

// Round 12
// Key Schedule
VPERMQ		$0x03, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y0, Y0
VPERMQ		$0x00, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y1, Y1
VPERMQ		$0x01, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y2, Y2
VPERMQ		$0x02, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y3, Y3
VPERMQ		$0x03, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y4, Y4
VPADDQ	Y9, Y5, Y5
VPERMQ		$0x00, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y6, Y6
VPERMQ		$0x01, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y7, Y7
VPADDQ	Y10, Y5, Y5
VPADDQ	Y11, Y6, Y6
VMOVNTDQA	round3<>(SB), Y15
VPADDQ Y15, Y7, Y7

	VPADDQ	Y0, Y1, Y0
	VPSLLQ	$39, Y1, Y15
	VPSRLQ	$25, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y0, Y1, Y1


	VPADDQ	Y2, Y3, Y2
	VPSLLQ	$30, Y3, Y15
	VPSRLQ	$34, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y2, Y3, Y3


	VPADDQ	Y4, Y5, Y4
	VPSLLQ	$34, Y5, Y15
	VPSRLQ	$30, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y4, Y5, Y5


	VPADDQ	Y6, Y7, Y6
	VPSLLQ	$24, Y7, Y15
	VPSRLQ	$40, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y6, Y7, Y7

// Round 13

	VPADDQ	Y2, Y1, Y2
	VPSLLQ	$13, Y1, Y15
	VPSRLQ	$51, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y2, Y1, Y1


	VPADDQ	Y4, Y7, Y4
	VPSLLQ	$50, Y7, Y15
	VPSRLQ	$14, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y4, Y7, Y7


	VPADDQ	Y6, Y5, Y6
	VPSLLQ	$10, Y5, Y15
	VPSRLQ	$54, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y6, Y5, Y5


	VPADDQ	Y0, Y3, Y0
	VPSLLQ	$17, Y3, Y15
	VPSRLQ	$47, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y0, Y3, Y3

// Round 14

	VPADDQ	Y4, Y1, Y4
	VPSLLQ	$25, Y1, Y15
	VPSRLQ	$39, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y4, Y1, Y1


	VPADDQ	Y6, Y3, Y6
	VPSLLQ	$29, Y3, Y15
	VPSRLQ	$35, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y6, Y3, Y3


	VPADDQ	Y0, Y5, Y0
	VPSLLQ	$39, Y5, Y15
	VPSRLQ	$25, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y0, Y5, Y5


	VPADDQ	Y2, Y7, Y2
	VPSLLQ	$43, Y7, Y15
	VPSRLQ	$21, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y2, Y7, Y7

// Round 15

	VPADDQ	Y6, Y1, Y6
	VPSLLQ	$8, Y1, Y15
	VPSRLQ	$56, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y6, Y1, Y1


	VPADDQ	Y0, Y7, Y0
	VPSLLQ	$35, Y7, Y15
	VPSRLQ	$29, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y0, Y7, Y7


	VPADDQ	Y2, Y5, Y2
	VPSLLQ	$56, Y5, Y15
	VPSRLQ	$8, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y2, Y5, Y5


	VPADDQ	Y4, Y3, Y4
	VPSLLQ	$22, Y3, Y15
	VPSRLQ	$42, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y4, Y3, Y3

// Round 16
// Key Schedule
VPERMQ		$0x00, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y0, Y0
VPERMQ		$0x01, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y1, Y1
VPERMQ		$0x02, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y2, Y2
VPERMQ		$0x03, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y3, Y3
VPADDQ	Y9, Y4, Y4
VPERMQ		$0x00, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y5, Y5
VPERMQ		$0x01, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y6, Y6
VPERMQ		$0x02, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y7, Y7
VPADDQ	Y11, Y5, Y5
VPADDQ	Y12, Y6, Y6
VMOVNTDQA	round4<>(SB), Y15
VPADDQ Y15, Y7, Y7

	VPADDQ	Y0, Y1, Y0
	VPSLLQ	$46, Y1, Y15
	VPSRLQ	$18, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y0, Y1, Y1


	VPADDQ	Y2, Y3, Y2
	VPSLLQ	$36, Y3, Y15
	VPSRLQ	$28, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y2, Y3, Y3


	VPADDQ	Y4, Y5, Y4
	VPSLLQ	$19, Y5, Y15
	VPSRLQ	$45, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y4, Y5, Y5


	VPADDQ	Y6, Y7, Y6
	VPSLLQ	$37, Y7, Y15
	VPSRLQ	$27, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y6, Y7, Y7

// Round 17

	VPADDQ	Y2, Y1, Y2
	VPSLLQ	$33, Y1, Y15
	VPSRLQ	$31, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y2, Y1, Y1


	VPADDQ	Y4, Y7, Y4
	VPSLLQ	$27, Y7, Y15
	VPSRLQ	$37, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y4, Y7, Y7


	VPADDQ	Y6, Y5, Y6
	VPSLLQ	$14, Y5, Y15
	VPSRLQ	$50, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y6, Y5, Y5


	VPADDQ	Y0, Y3, Y0
	VPSLLQ	$42, Y3, Y15
	VPSRLQ	$22, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y0, Y3, Y3

// Round 18

	VPADDQ	Y4, Y1, Y4
	VPSLLQ	$17, Y1, Y15
	VPSRLQ	$47, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y4, Y1, Y1


	VPADDQ	Y6, Y3, Y6
	VPSLLQ	$49, Y3, Y15
	VPSRLQ	$15, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y6, Y3, Y3


	VPADDQ	Y0, Y5, Y0
	VPSLLQ	$36, Y5, Y15
	VPSRLQ	$28, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y0, Y5, Y5


	VPADDQ	Y2, Y7, Y2
	VPSLLQ	$39, Y7, Y15
	VPSRLQ	$25, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y2, Y7, Y7

// Round 19

	VPADDQ	Y6, Y1, Y6
	VPSLLQ	$44, Y1, Y15
	VPSRLQ	$20, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y6, Y1, Y1


	VPADDQ	Y0, Y7, Y0
	VPSLLQ	$9, Y7, Y15
	VPSRLQ	$55, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y0, Y7, Y7


	VPADDQ	Y2, Y5, Y2
	VPSLLQ	$54, Y5, Y15
	VPSRLQ	$10, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y2, Y5, Y5


	VPADDQ	Y4, Y3, Y4
	VPSLLQ	$56, Y3, Y15
	VPSRLQ	$8, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y4, Y3, Y3

// Round 20
// Key Schedule
VPERMQ		$0x01, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y0, Y0
VPERMQ		$0x02, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y1, Y1
VPERMQ		$0x03, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y2, Y2
VPADDQ	Y9, Y3, Y3
VPERMQ		$0x00, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y4, Y4
VPERMQ		$0x01, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y5, Y5
VPERMQ		$0x02, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y6, Y6
VPERMQ		$0x03, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y7, Y7
VPADDQ	Y12, Y5, Y5
VPADDQ	Y10, Y6, Y6
VMOVNTDQA	round5<>(SB), Y15
VPADDQ Y15, Y7, Y7

	VPADDQ	Y0, Y1, Y0
	VPSLLQ	$39, Y1, Y15
	VPSRLQ	$25, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y0, Y1, Y1


	VPADDQ	Y2, Y3, Y2
	VPSLLQ	$30, Y3, Y15
	VPSRLQ	$34, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y2, Y3, Y3


	VPADDQ	Y4, Y5, Y4
	VPSLLQ	$34, Y5, Y15
	VPSRLQ	$30, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y4, Y5, Y5


	VPADDQ	Y6, Y7, Y6
	VPSLLQ	$24, Y7, Y15
	VPSRLQ	$40, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y6, Y7, Y7

// Round 21

	VPADDQ	Y2, Y1, Y2
	VPSLLQ	$13, Y1, Y15
	VPSRLQ	$51, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y2, Y1, Y1


	VPADDQ	Y4, Y7, Y4
	VPSLLQ	$50, Y7, Y15
	VPSRLQ	$14, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y4, Y7, Y7


	VPADDQ	Y6, Y5, Y6
	VPSLLQ	$10, Y5, Y15
	VPSRLQ	$54, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y6, Y5, Y5


	VPADDQ	Y0, Y3, Y0
	VPSLLQ	$17, Y3, Y15
	VPSRLQ	$47, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y0, Y3, Y3

// Round 22

	VPADDQ	Y4, Y1, Y4
	VPSLLQ	$25, Y1, Y15
	VPSRLQ	$39, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y4, Y1, Y1


	VPADDQ	Y6, Y3, Y6
	VPSLLQ	$29, Y3, Y15
	VPSRLQ	$35, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y6, Y3, Y3


	VPADDQ	Y0, Y5, Y0
	VPSLLQ	$39, Y5, Y15
	VPSRLQ	$25, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y0, Y5, Y5


	VPADDQ	Y2, Y7, Y2
	VPSLLQ	$43, Y7, Y15
	VPSRLQ	$21, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y2, Y7, Y7

// Round 23

	VPADDQ	Y6, Y1, Y6
	VPSLLQ	$8, Y1, Y15
	VPSRLQ	$56, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y6, Y1, Y1


	VPADDQ	Y0, Y7, Y0
	VPSLLQ	$35, Y7, Y15
	VPSRLQ	$29, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y0, Y7, Y7


	VPADDQ	Y2, Y5, Y2
	VPSLLQ	$56, Y5, Y15
	VPSRLQ	$8, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y2, Y5, Y5


	VPADDQ	Y4, Y3, Y4
	VPSLLQ	$22, Y3, Y15
	VPSRLQ	$42, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y4, Y3, Y3

// Round 24
// Key Schedule
VPERMQ		$0x02, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y0, Y0
VPERMQ		$0x03, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y1, Y1
VPADDQ	Y9, Y2, Y2
VPERMQ		$0x00, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y3, Y3
VPERMQ		$0x01, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y4, Y4
VPERMQ		$0x02, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y5, Y5
VPERMQ		$0x03, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y6, Y6
VPERMQ		$0x00, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y7, Y7
VPADDQ	Y10, Y5, Y5
VPADDQ	Y11, Y6, Y6
VMOVNTDQA	round6<>(SB), Y15
VPADDQ Y15, Y7, Y7

	VPADDQ	Y0, Y1, Y0
	VPSLLQ	$46, Y1, Y15
	VPSRLQ	$18, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y0, Y1, Y1


	VPADDQ	Y2, Y3, Y2
	VPSLLQ	$36, Y3, Y15
	VPSRLQ	$28, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y2, Y3, Y3


	VPADDQ	Y4, Y5, Y4
	VPSLLQ	$19, Y5, Y15
	VPSRLQ	$45, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y4, Y5, Y5


	VPADDQ	Y6, Y7, Y6
	VPSLLQ	$37, Y7, Y15
	VPSRLQ	$27, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y6, Y7, Y7

// Round 25

	VPADDQ	Y2, Y1, Y2
	VPSLLQ	$33, Y1, Y15
	VPSRLQ	$31, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y2, Y1, Y1


	VPADDQ	Y4, Y7, Y4
	VPSLLQ	$27, Y7, Y15
	VPSRLQ	$37, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y4, Y7, Y7


	VPADDQ	Y6, Y5, Y6
	VPSLLQ	$14, Y5, Y15
	VPSRLQ	$50, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y6, Y5, Y5


	VPADDQ	Y0, Y3, Y0
	VPSLLQ	$42, Y3, Y15
	VPSRLQ	$22, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y0, Y3, Y3

// Round 26

	VPADDQ	Y4, Y1, Y4
	VPSLLQ	$17, Y1, Y15
	VPSRLQ	$47, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y4, Y1, Y1


	VPADDQ	Y6, Y3, Y6
	VPSLLQ	$49, Y3, Y15
	VPSRLQ	$15, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y6, Y3, Y3


	VPADDQ	Y0, Y5, Y0
	VPSLLQ	$36, Y5, Y15
	VPSRLQ	$28, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y0, Y5, Y5


	VPADDQ	Y2, Y7, Y2
	VPSLLQ	$39, Y7, Y15
	VPSRLQ	$25, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y2, Y7, Y7

// Round 27

	VPADDQ	Y6, Y1, Y6
	VPSLLQ	$44, Y1, Y15
	VPSRLQ	$20, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y6, Y1, Y1


	VPADDQ	Y0, Y7, Y0
	VPSLLQ	$9, Y7, Y15
	VPSRLQ	$55, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y0, Y7, Y7


	VPADDQ	Y2, Y5, Y2
	VPSLLQ	$54, Y5, Y15
	VPSRLQ	$10, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y2, Y5, Y5


	VPADDQ	Y4, Y3, Y4
	VPSLLQ	$56, Y3, Y15
	VPSRLQ	$8, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y4, Y3, Y3

// Round 28
// Key Schedule
VPERMQ		$0x03, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y0, Y0
VPADDQ	Y9, Y1, Y1
VPERMQ		$0x00, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y2, Y2
VPERMQ		$0x01, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y3, Y3
VPERMQ		$0x02, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y4, Y4
VPERMQ		$0x03, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y5, Y5
VPERMQ		$0x00, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y6, Y6
VPERMQ		$0x01, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y7, Y7
VPADDQ	Y11, Y5, Y5
VPADDQ	Y12, Y6, Y6
VMOVNTDQA	round7<>(SB), Y15
VPADDQ Y15, Y7, Y7

	VPADDQ	Y0, Y1, Y0
	VPSLLQ	$39, Y1, Y15
	VPSRLQ	$25, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y0, Y1, Y1


	VPADDQ	Y2, Y3, Y2
	VPSLLQ	$30, Y3, Y15
	VPSRLQ	$34, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y2, Y3, Y3


	VPADDQ	Y4, Y5, Y4
	VPSLLQ	$34, Y5, Y15
	VPSRLQ	$30, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y4, Y5, Y5


	VPADDQ	Y6, Y7, Y6
	VPSLLQ	$24, Y7, Y15
	VPSRLQ	$40, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y6, Y7, Y7

// Round 29

	VPADDQ	Y2, Y1, Y2
	VPSLLQ	$13, Y1, Y15
	VPSRLQ	$51, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y2, Y1, Y1


	VPADDQ	Y4, Y7, Y4
	VPSLLQ	$50, Y7, Y15
	VPSRLQ	$14, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y4, Y7, Y7


	VPADDQ	Y6, Y5, Y6
	VPSLLQ	$10, Y5, Y15
	VPSRLQ	$54, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y6, Y5, Y5


	VPADDQ	Y0, Y3, Y0
	VPSLLQ	$17, Y3, Y15
	VPSRLQ	$47, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y0, Y3, Y3

// Round 30

	VPADDQ	Y4, Y1, Y4
	VPSLLQ	$25, Y1, Y15
	VPSRLQ	$39, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y4, Y1, Y1


	VPADDQ	Y6, Y3, Y6
	VPSLLQ	$29, Y3, Y15
	VPSRLQ	$35, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y6, Y3, Y3


	VPADDQ	Y0, Y5, Y0
	VPSLLQ	$39, Y5, Y15
	VPSRLQ	$25, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y0, Y5, Y5


	VPADDQ	Y2, Y7, Y2
	VPSLLQ	$43, Y7, Y15
	VPSRLQ	$21, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y2, Y7, Y7

// Round 31

	VPADDQ	Y6, Y1, Y6
	VPSLLQ	$8, Y1, Y15
	VPSRLQ	$56, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y6, Y1, Y1


	VPADDQ	Y0, Y7, Y0
	VPSLLQ	$35, Y7, Y15
	VPSRLQ	$29, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y0, Y7, Y7


	VPADDQ	Y2, Y5, Y2
	VPSLLQ	$56, Y5, Y15
	VPSRLQ	$8, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y2, Y5, Y5


	VPADDQ	Y4, Y3, Y4
	VPSLLQ	$22, Y3, Y15
	VPSRLQ	$42, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y4, Y3, Y3

// Round 32
// Key Schedule
VPADDQ	Y9, Y0, Y0
VPERMQ		$0x00, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y1, Y1
VPERMQ		$0x01, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y2, Y2
VPERMQ		$0x02, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y3, Y3
VPERMQ		$0x03, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y4, Y4
VPERMQ		$0x00, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y5, Y5
VPERMQ		$0x01, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y6, Y6
VPERMQ		$0x02, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y7, Y7
VPADDQ	Y12, Y5, Y5
VPADDQ	Y10, Y6, Y6
VMOVNTDQA	round8<>(SB), Y15
VPADDQ Y15, Y7, Y7

	VPADDQ	Y0, Y1, Y0
	VPSLLQ	$46, Y1, Y15
	VPSRLQ	$18, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y0, Y1, Y1


	VPADDQ	Y2, Y3, Y2
	VPSLLQ	$36, Y3, Y15
	VPSRLQ	$28, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y2, Y3, Y3


	VPADDQ	Y4, Y5, Y4
	VPSLLQ	$19, Y5, Y15
	VPSRLQ	$45, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y4, Y5, Y5


	VPADDQ	Y6, Y7, Y6
	VPSLLQ	$37, Y7, Y15
	VPSRLQ	$27, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y6, Y7, Y7

// Round 33

	VPADDQ	Y2, Y1, Y2
	VPSLLQ	$33, Y1, Y15
	VPSRLQ	$31, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y2, Y1, Y1


	VPADDQ	Y4, Y7, Y4
	VPSLLQ	$27, Y7, Y15
	VPSRLQ	$37, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y4, Y7, Y7


	VPADDQ	Y6, Y5, Y6
	VPSLLQ	$14, Y5, Y15
	VPSRLQ	$50, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y6, Y5, Y5


	VPADDQ	Y0, Y3, Y0
	VPSLLQ	$42, Y3, Y15
	VPSRLQ	$22, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y0, Y3, Y3

// Round 34

	VPADDQ	Y4, Y1, Y4
	VPSLLQ	$17, Y1, Y15
	VPSRLQ	$47, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y4, Y1, Y1


	VPADDQ	Y6, Y3, Y6
	VPSLLQ	$49, Y3, Y15
	VPSRLQ	$15, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y6, Y3, Y3


	VPADDQ	Y0, Y5, Y0
	VPSLLQ	$36, Y5, Y15
	VPSRLQ	$28, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y0, Y5, Y5


	VPADDQ	Y2, Y7, Y2
	VPSLLQ	$39, Y7, Y15
	VPSRLQ	$25, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y2, Y7, Y7

// Round 35

	VPADDQ	Y6, Y1, Y6
	VPSLLQ	$44, Y1, Y15
	VPSRLQ	$20, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y6, Y1, Y1


	VPADDQ	Y0, Y7, Y0
	VPSLLQ	$9, Y7, Y15
	VPSRLQ	$55, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y0, Y7, Y7


	VPADDQ	Y2, Y5, Y2
	VPSLLQ	$54, Y5, Y15
	VPSRLQ	$10, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y2, Y5, Y5


	VPADDQ	Y4, Y3, Y4
	VPSLLQ	$56, Y3, Y15
	VPSRLQ	$8, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y4, Y3, Y3

// Round 36
// Key Schedule
VPERMQ		$0x00, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y0, Y0
VPERMQ		$0x01, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y1, Y1
VPERMQ		$0x02, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y2, Y2
VPERMQ		$0x03, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y3, Y3
VPERMQ		$0x00, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y4, Y4
VPERMQ		$0x01, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y5, Y5
VPERMQ		$0x02, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y6, Y6
VPERMQ		$0x03, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y7, Y7
VPADDQ	Y10, Y5, Y5
VPADDQ	Y11, Y6, Y6
VMOVNTDQA	round9<>(SB), Y15
VPADDQ Y15, Y7, Y7

	VPADDQ	Y0, Y1, Y0
	VPSLLQ	$39, Y1, Y15
	VPSRLQ	$25, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y0, Y1, Y1


	VPADDQ	Y2, Y3, Y2
	VPSLLQ	$30, Y3, Y15
	VPSRLQ	$34, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y2, Y3, Y3


	VPADDQ	Y4, Y5, Y4
	VPSLLQ	$34, Y5, Y15
	VPSRLQ	$30, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y4, Y5, Y5


	VPADDQ	Y6, Y7, Y6
	VPSLLQ	$24, Y7, Y15
	VPSRLQ	$40, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y6, Y7, Y7

// Round 37

	VPADDQ	Y2, Y1, Y2
	VPSLLQ	$13, Y1, Y15
	VPSRLQ	$51, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y2, Y1, Y1


	VPADDQ	Y4, Y7, Y4
	VPSLLQ	$50, Y7, Y15
	VPSRLQ	$14, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y4, Y7, Y7


	VPADDQ	Y6, Y5, Y6
	VPSLLQ	$10, Y5, Y15
	VPSRLQ	$54, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y6, Y5, Y5


	VPADDQ	Y0, Y3, Y0
	VPSLLQ	$17, Y3, Y15
	VPSRLQ	$47, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y0, Y3, Y3

// Round 38

	VPADDQ	Y4, Y1, Y4
	VPSLLQ	$25, Y1, Y15
	VPSRLQ	$39, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y4, Y1, Y1


	VPADDQ	Y6, Y3, Y6
	VPSLLQ	$29, Y3, Y15
	VPSRLQ	$35, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y6, Y3, Y3


	VPADDQ	Y0, Y5, Y0
	VPSLLQ	$39, Y5, Y15
	VPSRLQ	$25, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y0, Y5, Y5


	VPADDQ	Y2, Y7, Y2
	VPSLLQ	$43, Y7, Y15
	VPSRLQ	$21, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y2, Y7, Y7

// Round 39

	VPADDQ	Y6, Y1, Y6
	VPSLLQ	$8, Y1, Y15
	VPSRLQ	$56, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y6, Y1, Y1


	VPADDQ	Y0, Y7, Y0
	VPSLLQ	$35, Y7, Y15
	VPSRLQ	$29, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y0, Y7, Y7


	VPADDQ	Y2, Y5, Y2
	VPSLLQ	$56, Y5, Y15
	VPSRLQ	$8, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y2, Y5, Y5


	VPADDQ	Y4, Y3, Y4
	VPSLLQ	$22, Y3, Y15
	VPSRLQ	$42, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y4, Y3, Y3

// Round 40
// Key Schedule
VPERMQ		$0x01, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y0, Y0
VPERMQ		$0x02, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y1, Y1
VPERMQ		$0x03, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y2, Y2
VPERMQ		$0x00, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y3, Y3
VPERMQ		$0x01, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y4, Y4
VPERMQ		$0x02, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y5, Y5
VPERMQ		$0x03, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y6, Y6
VPADDQ	Y9, Y7, Y7
VPADDQ	Y11, Y5, Y5
VPADDQ	Y12, Y6, Y6
VMOVNTDQA	round10<>(SB), Y15
VPADDQ Y15, Y7, Y7

	VPADDQ	Y0, Y1, Y0
	VPSLLQ	$46, Y1, Y15
	VPSRLQ	$18, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y0, Y1, Y1


	VPADDQ	Y2, Y3, Y2
	VPSLLQ	$36, Y3, Y15
	VPSRLQ	$28, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y2, Y3, Y3


	VPADDQ	Y4, Y5, Y4
	VPSLLQ	$19, Y5, Y15
	VPSRLQ	$45, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y4, Y5, Y5


	VPADDQ	Y6, Y7, Y6
	VPSLLQ	$37, Y7, Y15
	VPSRLQ	$27, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y6, Y7, Y7

// Round 41

	VPADDQ	Y2, Y1, Y2
	VPSLLQ	$33, Y1, Y15
	VPSRLQ	$31, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y2, Y1, Y1


	VPADDQ	Y4, Y7, Y4
	VPSLLQ	$27, Y7, Y15
	VPSRLQ	$37, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y4, Y7, Y7


	VPADDQ	Y6, Y5, Y6
	VPSLLQ	$14, Y5, Y15
	VPSRLQ	$50, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y6, Y5, Y5


	VPADDQ	Y0, Y3, Y0
	VPSLLQ	$42, Y3, Y15
	VPSRLQ	$22, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y0, Y3, Y3

// Round 42

	VPADDQ	Y4, Y1, Y4
	VPSLLQ	$17, Y1, Y15
	VPSRLQ	$47, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y4, Y1, Y1


	VPADDQ	Y6, Y3, Y6
	VPSLLQ	$49, Y3, Y15
	VPSRLQ	$15, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y6, Y3, Y3


	VPADDQ	Y0, Y5, Y0
	VPSLLQ	$36, Y5, Y15
	VPSRLQ	$28, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y0, Y5, Y5


	VPADDQ	Y2, Y7, Y2
	VPSLLQ	$39, Y7, Y15
	VPSRLQ	$25, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y2, Y7, Y7

// Round 43

	VPADDQ	Y6, Y1, Y6
	VPSLLQ	$44, Y1, Y15
	VPSRLQ	$20, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y6, Y1, Y1


	VPADDQ	Y0, Y7, Y0
	VPSLLQ	$9, Y7, Y15
	VPSRLQ	$55, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y0, Y7, Y7


	VPADDQ	Y2, Y5, Y2
	VPSLLQ	$54, Y5, Y15
	VPSRLQ	$10, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y2, Y5, Y5


	VPADDQ	Y4, Y3, Y4
	VPSLLQ	$56, Y3, Y15
	VPSRLQ	$8, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y4, Y3, Y3

// Round 44
// Key Schedule
VPERMQ		$0x02, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y0, Y0
VPERMQ		$0x03, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y1, Y1
VPERMQ		$0x00, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y2, Y2
VPERMQ		$0x01, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y3, Y3
VPERMQ		$0x02, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y4, Y4
VPERMQ		$0x03, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y5, Y5
VPADDQ	Y9, Y6, Y6
VPERMQ		$0x00, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y7, Y7
VPADDQ	Y12, Y5, Y5
VPADDQ	Y10, Y6, Y6
VMOVNTDQA	round11<>(SB), Y15
VPADDQ Y15, Y7, Y7

	VPADDQ	Y0, Y1, Y0
	VPSLLQ	$39, Y1, Y15
	VPSRLQ	$25, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y0, Y1, Y1


	VPADDQ	Y2, Y3, Y2
	VPSLLQ	$30, Y3, Y15
	VPSRLQ	$34, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y2, Y3, Y3


	VPADDQ	Y4, Y5, Y4
	VPSLLQ	$34, Y5, Y15
	VPSRLQ	$30, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y4, Y5, Y5


	VPADDQ	Y6, Y7, Y6
	VPSLLQ	$24, Y7, Y15
	VPSRLQ	$40, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y6, Y7, Y7

// Round 45

	VPADDQ	Y2, Y1, Y2
	VPSLLQ	$13, Y1, Y15
	VPSRLQ	$51, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y2, Y1, Y1


	VPADDQ	Y4, Y7, Y4
	VPSLLQ	$50, Y7, Y15
	VPSRLQ	$14, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y4, Y7, Y7


	VPADDQ	Y6, Y5, Y6
	VPSLLQ	$10, Y5, Y15
	VPSRLQ	$54, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y6, Y5, Y5


	VPADDQ	Y0, Y3, Y0
	VPSLLQ	$17, Y3, Y15
	VPSRLQ	$47, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y0, Y3, Y3

// Round 46

	VPADDQ	Y4, Y1, Y4
	VPSLLQ	$25, Y1, Y15
	VPSRLQ	$39, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y4, Y1, Y1


	VPADDQ	Y6, Y3, Y6
	VPSLLQ	$29, Y3, Y15
	VPSRLQ	$35, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y6, Y3, Y3


	VPADDQ	Y0, Y5, Y0
	VPSLLQ	$39, Y5, Y15
	VPSRLQ	$25, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y0, Y5, Y5


	VPADDQ	Y2, Y7, Y2
	VPSLLQ	$43, Y7, Y15
	VPSRLQ	$21, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y2, Y7, Y7

// Round 47

	VPADDQ	Y6, Y1, Y6
	VPSLLQ	$8, Y1, Y15
	VPSRLQ	$56, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y6, Y1, Y1


	VPADDQ	Y0, Y7, Y0
	VPSLLQ	$35, Y7, Y15
	VPSRLQ	$29, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y0, Y7, Y7


	VPADDQ	Y2, Y5, Y2
	VPSLLQ	$56, Y5, Y15
	VPSRLQ	$8, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y2, Y5, Y5


	VPADDQ	Y4, Y3, Y4
	VPSLLQ	$22, Y3, Y15
	VPSRLQ	$42, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y4, Y3, Y3

// Round 48
// Key Schedule
VPERMQ		$0x03, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y0, Y0
VPERMQ		$0x00, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y1, Y1
VPERMQ		$0x01, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y2, Y2
VPERMQ		$0x02, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y3, Y3
VPERMQ		$0x03, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y4, Y4
VPADDQ	Y9, Y5, Y5
VPERMQ		$0x00, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y6, Y6
VPERMQ		$0x01, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y7, Y7
VPADDQ	Y10, Y5, Y5
VPADDQ	Y11, Y6, Y6
VMOVNTDQA	round12<>(SB), Y15
VPADDQ Y15, Y7, Y7

	VPADDQ	Y0, Y1, Y0
	VPSLLQ	$46, Y1, Y15
	VPSRLQ	$18, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y0, Y1, Y1


	VPADDQ	Y2, Y3, Y2
	VPSLLQ	$36, Y3, Y15
	VPSRLQ	$28, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y2, Y3, Y3


	VPADDQ	Y4, Y5, Y4
	VPSLLQ	$19, Y5, Y15
	VPSRLQ	$45, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y4, Y5, Y5


	VPADDQ	Y6, Y7, Y6
	VPSLLQ	$37, Y7, Y15
	VPSRLQ	$27, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y6, Y7, Y7

// Round 49

	VPADDQ	Y2, Y1, Y2
	VPSLLQ	$33, Y1, Y15
	VPSRLQ	$31, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y2, Y1, Y1


	VPADDQ	Y4, Y7, Y4
	VPSLLQ	$27, Y7, Y15
	VPSRLQ	$37, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y4, Y7, Y7


	VPADDQ	Y6, Y5, Y6
	VPSLLQ	$14, Y5, Y15
	VPSRLQ	$50, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y6, Y5, Y5


	VPADDQ	Y0, Y3, Y0
	VPSLLQ	$42, Y3, Y15
	VPSRLQ	$22, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y0, Y3, Y3

// Round 50

	VPADDQ	Y4, Y1, Y4
	VPSLLQ	$17, Y1, Y15
	VPSRLQ	$47, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y4, Y1, Y1


	VPADDQ	Y6, Y3, Y6
	VPSLLQ	$49, Y3, Y15
	VPSRLQ	$15, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y6, Y3, Y3


	VPADDQ	Y0, Y5, Y0
	VPSLLQ	$36, Y5, Y15
	VPSRLQ	$28, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y0, Y5, Y5


	VPADDQ	Y2, Y7, Y2
	VPSLLQ	$39, Y7, Y15
	VPSRLQ	$25, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y2, Y7, Y7

// Round 51

	VPADDQ	Y6, Y1, Y6
	VPSLLQ	$44, Y1, Y15
	VPSRLQ	$20, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y6, Y1, Y1


	VPADDQ	Y0, Y7, Y0
	VPSLLQ	$9, Y7, Y15
	VPSRLQ	$55, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y0, Y7, Y7


	VPADDQ	Y2, Y5, Y2
	VPSLLQ	$54, Y5, Y15
	VPSRLQ	$10, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y2, Y5, Y5


	VPADDQ	Y4, Y3, Y4
	VPSLLQ	$56, Y3, Y15
	VPSRLQ	$8, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y4, Y3, Y3

// Round 52
// Key Schedule
VPERMQ		$0x00, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y0, Y0
VPERMQ		$0x01, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y1, Y1
VPERMQ		$0x02, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y2, Y2
VPERMQ		$0x03, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y3, Y3
VPADDQ	Y9, Y4, Y4
VPERMQ		$0x00, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y5, Y5
VPERMQ		$0x01, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y6, Y6
VPERMQ		$0x02, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y7, Y7
VPADDQ	Y11, Y5, Y5
VPADDQ	Y12, Y6, Y6
VMOVNTDQA	round13<>(SB), Y15
VPADDQ Y15, Y7, Y7

	VPADDQ	Y0, Y1, Y0
	VPSLLQ	$39, Y1, Y15
	VPSRLQ	$25, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y0, Y1, Y1


	VPADDQ	Y2, Y3, Y2
	VPSLLQ	$30, Y3, Y15
	VPSRLQ	$34, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y2, Y3, Y3


	VPADDQ	Y4, Y5, Y4
	VPSLLQ	$34, Y5, Y15
	VPSRLQ	$30, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y4, Y5, Y5


	VPADDQ	Y6, Y7, Y6
	VPSLLQ	$24, Y7, Y15
	VPSRLQ	$40, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y6, Y7, Y7

// Round 53

	VPADDQ	Y2, Y1, Y2
	VPSLLQ	$13, Y1, Y15
	VPSRLQ	$51, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y2, Y1, Y1


	VPADDQ	Y4, Y7, Y4
	VPSLLQ	$50, Y7, Y15
	VPSRLQ	$14, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y4, Y7, Y7


	VPADDQ	Y6, Y5, Y6
	VPSLLQ	$10, Y5, Y15
	VPSRLQ	$54, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y6, Y5, Y5


	VPADDQ	Y0, Y3, Y0
	VPSLLQ	$17, Y3, Y15
	VPSRLQ	$47, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y0, Y3, Y3

// Round 54

	VPADDQ	Y4, Y1, Y4
	VPSLLQ	$25, Y1, Y15
	VPSRLQ	$39, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y4, Y1, Y1


	VPADDQ	Y6, Y3, Y6
	VPSLLQ	$29, Y3, Y15
	VPSRLQ	$35, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y6, Y3, Y3


	VPADDQ	Y0, Y5, Y0
	VPSLLQ	$39, Y5, Y15
	VPSRLQ	$25, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y0, Y5, Y5


	VPADDQ	Y2, Y7, Y2
	VPSLLQ	$43, Y7, Y15
	VPSRLQ	$21, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y2, Y7, Y7

// Round 55

	VPADDQ	Y6, Y1, Y6
	VPSLLQ	$8, Y1, Y15
	VPSRLQ	$56, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y6, Y1, Y1


	VPADDQ	Y0, Y7, Y0
	VPSLLQ	$35, Y7, Y15
	VPSRLQ	$29, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y0, Y7, Y7


	VPADDQ	Y2, Y5, Y2
	VPSLLQ	$56, Y5, Y15
	VPSRLQ	$8, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y2, Y5, Y5


	VPADDQ	Y4, Y3, Y4
	VPSLLQ	$22, Y3, Y15
	VPSRLQ	$42, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y4, Y3, Y3

// Round 56
// Key Schedule
VPERMQ		$0x01, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y0, Y0
VPERMQ		$0x02, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y1, Y1
VPERMQ		$0x03, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y2, Y2
VPADDQ	Y9, Y3, Y3
VPERMQ		$0x00, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y4, Y4
VPERMQ		$0x01, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y5, Y5
VPERMQ		$0x02, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y6, Y6
VPERMQ		$0x03, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y7, Y7
VPADDQ	Y12, Y5, Y5
VPADDQ	Y10, Y6, Y6
VMOVNTDQA	round14<>(SB), Y15
VPADDQ Y15, Y7, Y7

	VPADDQ	Y0, Y1, Y0
	VPSLLQ	$46, Y1, Y15
	VPSRLQ	$18, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y0, Y1, Y1


	VPADDQ	Y2, Y3, Y2
	VPSLLQ	$36, Y3, Y15
	VPSRLQ	$28, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y2, Y3, Y3


	VPADDQ	Y4, Y5, Y4
	VPSLLQ	$19, Y5, Y15
	VPSRLQ	$45, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y4, Y5, Y5


	VPADDQ	Y6, Y7, Y6
	VPSLLQ	$37, Y7, Y15
	VPSRLQ	$27, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y6, Y7, Y7

// Round 57

	VPADDQ	Y2, Y1, Y2
	VPSLLQ	$33, Y1, Y15
	VPSRLQ	$31, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y2, Y1, Y1


	VPADDQ	Y4, Y7, Y4
	VPSLLQ	$27, Y7, Y15
	VPSRLQ	$37, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y4, Y7, Y7


	VPADDQ	Y6, Y5, Y6
	VPSLLQ	$14, Y5, Y15
	VPSRLQ	$50, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y6, Y5, Y5


	VPADDQ	Y0, Y3, Y0
	VPSLLQ	$42, Y3, Y15
	VPSRLQ	$22, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y0, Y3, Y3

// Round 58

	VPADDQ	Y4, Y1, Y4
	VPSLLQ	$17, Y1, Y15
	VPSRLQ	$47, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y4, Y1, Y1


	VPADDQ	Y6, Y3, Y6
	VPSLLQ	$49, Y3, Y15
	VPSRLQ	$15, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y6, Y3, Y3


	VPADDQ	Y0, Y5, Y0
	VPSLLQ	$36, Y5, Y15
	VPSRLQ	$28, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y0, Y5, Y5


	VPADDQ	Y2, Y7, Y2
	VPSLLQ	$39, Y7, Y15
	VPSRLQ	$25, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y2, Y7, Y7

// Round 59

	VPADDQ	Y6, Y1, Y6
	VPSLLQ	$44, Y1, Y15
	VPSRLQ	$20, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y6, Y1, Y1


	VPADDQ	Y0, Y7, Y0
	VPSLLQ	$9, Y7, Y15
	VPSRLQ	$55, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y0, Y7, Y7


	VPADDQ	Y2, Y5, Y2
	VPSLLQ	$54, Y5, Y15
	VPSRLQ	$10, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y2, Y5, Y5


	VPADDQ	Y4, Y3, Y4
	VPSLLQ	$56, Y3, Y15
	VPSRLQ	$8, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y4, Y3, Y3

// Round 60
// Key Schedule
VPERMQ		$0x02, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y0, Y0
VPERMQ		$0x03, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y1, Y1
VPADDQ	Y9, Y2, Y2
VPERMQ		$0x00, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y3, Y3
VPERMQ		$0x01, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y4, Y4
VPERMQ		$0x02, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y5, Y5
VPERMQ		$0x03, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y6, Y6
VPERMQ		$0x00, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y7, Y7
VPADDQ	Y10, Y5, Y5
VPADDQ	Y11, Y6, Y6
VMOVNTDQA	round15<>(SB), Y15
VPADDQ Y15, Y7, Y7

	VPADDQ	Y0, Y1, Y0
	VPSLLQ	$39, Y1, Y15
	VPSRLQ	$25, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y0, Y1, Y1


	VPADDQ	Y2, Y3, Y2
	VPSLLQ	$30, Y3, Y15
	VPSRLQ	$34, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y2, Y3, Y3


	VPADDQ	Y4, Y5, Y4
	VPSLLQ	$34, Y5, Y15
	VPSRLQ	$30, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y4, Y5, Y5


	VPADDQ	Y6, Y7, Y6
	VPSLLQ	$24, Y7, Y15
	VPSRLQ	$40, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y6, Y7, Y7

// Round 61

	VPADDQ	Y2, Y1, Y2
	VPSLLQ	$13, Y1, Y15
	VPSRLQ	$51, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y2, Y1, Y1


	VPADDQ	Y4, Y7, Y4
	VPSLLQ	$50, Y7, Y15
	VPSRLQ	$14, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y4, Y7, Y7


	VPADDQ	Y6, Y5, Y6
	VPSLLQ	$10, Y5, Y15
	VPSRLQ	$54, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y6, Y5, Y5


	VPADDQ	Y0, Y3, Y0
	VPSLLQ	$17, Y3, Y15
	VPSRLQ	$47, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y0, Y3, Y3

// Round 62

	VPADDQ	Y4, Y1, Y4
	VPSLLQ	$25, Y1, Y15
	VPSRLQ	$39, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y4, Y1, Y1


	VPADDQ	Y6, Y3, Y6
	VPSLLQ	$29, Y3, Y15
	VPSRLQ	$35, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y6, Y3, Y3


	VPADDQ	Y0, Y5, Y0
	VPSLLQ	$39, Y5, Y15
	VPSRLQ	$25, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y0, Y5, Y5


	VPADDQ	Y2, Y7, Y2
	VPSLLQ	$43, Y7, Y15
	VPSRLQ	$21, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y2, Y7, Y7

// Round 63

	VPADDQ	Y6, Y1, Y6
	VPSLLQ	$8, Y1, Y15
	VPSRLQ	$56, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y6, Y1, Y1


	VPADDQ	Y0, Y7, Y0
	VPSLLQ	$35, Y7, Y15
	VPSRLQ	$29, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y0, Y7, Y7


	VPADDQ	Y2, Y5, Y2
	VPSLLQ	$56, Y5, Y15
	VPSRLQ	$8, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y2, Y5, Y5


	VPADDQ	Y4, Y3, Y4
	VPSLLQ	$22, Y3, Y15
	VPSRLQ	$42, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y4, Y3, Y3

// Round 64
// Key Schedule
VPERMQ		$0x03, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y0, Y0
VPADDQ	Y9, Y1, Y1
VPERMQ		$0x00, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y2, Y2
VPERMQ		$0x01, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y3, Y3
VPERMQ		$0x02, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y4, Y4
VPERMQ		$0x03, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y5, Y5
VPERMQ		$0x00, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y6, Y6
VPERMQ		$0x01, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y7, Y7
VPADDQ	Y11, Y5, Y5
VPADDQ	Y12, Y6, Y6
VMOVNTDQA	round16<>(SB), Y15
VPADDQ Y15, Y7, Y7

	VPADDQ	Y0, Y1, Y0
	VPSLLQ	$46, Y1, Y15
	VPSRLQ	$18, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y0, Y1, Y1


	VPADDQ	Y2, Y3, Y2
	VPSLLQ	$36, Y3, Y15
	VPSRLQ	$28, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y2, Y3, Y3


	VPADDQ	Y4, Y5, Y4
	VPSLLQ	$19, Y5, Y15
	VPSRLQ	$45, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y4, Y5, Y5


	VPADDQ	Y6, Y7, Y6
	VPSLLQ	$37, Y7, Y15
	VPSRLQ	$27, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y6, Y7, Y7

// Round 65

	VPADDQ	Y2, Y1, Y2
	VPSLLQ	$33, Y1, Y15
	VPSRLQ	$31, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y2, Y1, Y1


	VPADDQ	Y4, Y7, Y4
	VPSLLQ	$27, Y7, Y15
	VPSRLQ	$37, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y4, Y7, Y7


	VPADDQ	Y6, Y5, Y6
	VPSLLQ	$14, Y5, Y15
	VPSRLQ	$50, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y6, Y5, Y5


	VPADDQ	Y0, Y3, Y0
	VPSLLQ	$42, Y3, Y15
	VPSRLQ	$22, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y0, Y3, Y3

// Round 66

	VPADDQ	Y4, Y1, Y4
	VPSLLQ	$17, Y1, Y15
	VPSRLQ	$47, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y4, Y1, Y1


	VPADDQ	Y6, Y3, Y6
	VPSLLQ	$49, Y3, Y15
	VPSRLQ	$15, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y6, Y3, Y3


	VPADDQ	Y0, Y5, Y0
	VPSLLQ	$36, Y5, Y15
	VPSRLQ	$28, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y0, Y5, Y5


	VPADDQ	Y2, Y7, Y2
	VPSLLQ	$39, Y7, Y15
	VPSRLQ	$25, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y2, Y7, Y7

// Round 67

	VPADDQ	Y6, Y1, Y6
	VPSLLQ	$44, Y1, Y15
	VPSRLQ	$20, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y6, Y1, Y1


	VPADDQ	Y0, Y7, Y0
	VPSLLQ	$9, Y7, Y15
	VPSRLQ	$55, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y0, Y7, Y7


	VPADDQ	Y2, Y5, Y2
	VPSLLQ	$54, Y5, Y15
	VPSRLQ	$10, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y2, Y5, Y5


	VPADDQ	Y4, Y3, Y4
	VPSLLQ	$56, Y3, Y15
	VPSRLQ	$8, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y4, Y3, Y3

// Round 68
// Key Schedule
VPADDQ	Y9, Y0, Y0
VPERMQ		$0x00, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y1, Y1
VPERMQ		$0x01, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y2, Y2
VPERMQ		$0x02, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y3, Y3
VPERMQ		$0x03, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y4, Y4
VPERMQ		$0x00, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y5, Y5
VPERMQ		$0x01, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y6, Y6
VPERMQ		$0x02, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y7, Y7
VPADDQ	Y12, Y5, Y5
VPADDQ	Y10, Y6, Y6
VMOVNTDQA	round17<>(SB), Y15
VPADDQ Y15, Y7, Y7

	VPADDQ	Y0, Y1, Y0
	VPSLLQ	$39, Y1, Y15
	VPSRLQ	$25, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y0, Y1, Y1


	VPADDQ	Y2, Y3, Y2
	VPSLLQ	$30, Y3, Y15
	VPSRLQ	$34, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y2, Y3, Y3


	VPADDQ	Y4, Y5, Y4
	VPSLLQ	$34, Y5, Y15
	VPSRLQ	$30, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y4, Y5, Y5


	VPADDQ	Y6, Y7, Y6
	VPSLLQ	$24, Y7, Y15
	VPSRLQ	$40, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y6, Y7, Y7

// Round 69

	VPADDQ	Y2, Y1, Y2
	VPSLLQ	$13, Y1, Y15
	VPSRLQ	$51, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y2, Y1, Y1


	VPADDQ	Y4, Y7, Y4
	VPSLLQ	$50, Y7, Y15
	VPSRLQ	$14, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y4, Y7, Y7


	VPADDQ	Y6, Y5, Y6
	VPSLLQ	$10, Y5, Y15
	VPSRLQ	$54, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y6, Y5, Y5


	VPADDQ	Y0, Y3, Y0
	VPSLLQ	$17, Y3, Y15
	VPSRLQ	$47, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y0, Y3, Y3

// Round 70

	VPADDQ	Y4, Y1, Y4
	VPSLLQ	$25, Y1, Y15
	VPSRLQ	$39, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y4, Y1, Y1


	VPADDQ	Y6, Y3, Y6
	VPSLLQ	$29, Y3, Y15
	VPSRLQ	$35, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y6, Y3, Y3


	VPADDQ	Y0, Y5, Y0
	VPSLLQ	$39, Y5, Y15
	VPSRLQ	$25, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y0, Y5, Y5


	VPADDQ	Y2, Y7, Y2
	VPSLLQ	$43, Y7, Y15
	VPSRLQ	$21, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y2, Y7, Y7

// Round 71

	VPADDQ	Y6, Y1, Y6
	VPSLLQ	$8, Y1, Y15
	VPSRLQ	$56, Y1, Y1
	VPXOR	Y15, Y1, Y1
	VPXOR	Y6, Y1, Y1


	VPADDQ	Y0, Y7, Y0
	VPSLLQ	$35, Y7, Y15
	VPSRLQ	$29, Y7, Y7
	VPXOR	Y15, Y7, Y7
	VPXOR	Y0, Y7, Y7


	VPADDQ	Y2, Y5, Y2
	VPSLLQ	$56, Y5, Y15
	VPSRLQ	$8, Y5, Y5
	VPXOR	Y15, Y5, Y5
	VPXOR	Y2, Y5, Y5


	VPADDQ	Y4, Y3, Y4
	VPSLLQ	$22, Y3, Y15
	VPSRLQ	$42, Y3, Y3
	VPXOR	Y15, Y3, Y3
	VPXOR	Y4, Y3, Y3

// Key Schedule
VPERMQ		$0x00, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y0, Y0
VPERMQ		$0x01, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y1, Y1
VPERMQ		$0x02, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y2, Y2
VPERMQ		$0x03, Y13, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y3, Y3
VPERMQ		$0x00, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y4, Y4
VPERMQ		$0x01, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y5, Y5
VPERMQ		$0x02, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y6, Y6
VPERMQ		$0x03, Y14, Y15
VPBROADCASTQ	X15, Y15
VPADDQ		Y15, Y7, Y7
VPADDQ	Y10, Y5, Y5
VPADDQ	Y11, Y6, Y6
VMOVNTDQA	round18<>(SB), Y15
VPADDQ Y15, Y7, Y7



	VMOVNTDQA	gatherMask<>(SB), Y15

	// Store the state vectors back where we got them
	MOVQ state+0(FP), R10
	VPMASKMOVQ	Y0, Y15, 0(R10)
	VPMASKMOVQ	Y4, Y15, 32(R10)
	VPMASKMOVQ	Y1, Y15, 64(R10)
	VPMASKMOVQ	Y5, Y15, 96(R10)
	VPMASKMOVQ	Y2, Y15, 128(R10)
	VPMASKMOVQ	Y6, Y15, 160(R10)
	VPMASKMOVQ	Y3, Y15, 192(R10)
	VPMASKMOVQ	Y7, Y15, 224(R10)

	// Transpose the state in place

	MOVQ 8(R10), R8
	MOVQ 64(R10), R9
	MOVQ R9, 8(R10)
	MOVQ R8, 64(R10)

	MOVQ 16(R10), R8
	MOVQ 128(R10), R9
	MOVQ R9, 16(R10)
	MOVQ R8, 128(R10)

	MOVQ 24(R10), R8
	MOVQ 192(R10), R9
	MOVQ R9, 24(R10)
	MOVQ R8, 192(R10)

	MOVQ 40(R10), R8
	MOVQ 96(R10), R9
	MOVQ R9, 40(R10)
	MOVQ R8, 96(R10)

	MOVQ 48(R10), R8
	MOVQ 160(R10), R9
	MOVQ R9, 48(R10)
	MOVQ R8, 160(R10)

	MOVQ 56(R10), R8
	MOVQ 224(R10), R9
	MOVQ R9, 56(R10)
	MOVQ R8, 224(R10)

	MOVQ 80(R10), R8
	MOVQ 136(R10), R9
	MOVQ R9, 80(R10)
	MOVQ R8, 136(R10)

	MOVQ 88(R10), R8
	MOVQ 200(R10), R9
	MOVQ R9, 88(R10)
	MOVQ R8, 200(R10)

	MOVQ 112(R10), R8
	MOVQ 168(R10), R9
	MOVQ R9, 112(R10)
	MOVQ R8, 168(R10)

	MOVQ 120(R10), R8
	MOVQ 232(R10), R9
	MOVQ R9, 120(R10)
	MOVQ R8, 232(R10)

	MOVQ 152(R10), R8
	MOVQ 208(R10), R9
	MOVQ R9, 152(R10)
	MOVQ R8, 208(R10)

	MOVQ 184(R10), R8
	MOVQ 240(R10), R9
	MOVQ R9, 184(R10)
	MOVQ R8, 240(R10)


	RET
